code from [here](http://forum.lazarus.freepascal.org/index.php?topic=20401.0) by graeme.
